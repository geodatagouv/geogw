<ol class="breadcrumb">
  <li>Accueil</li>
  <li><a href="/services">Services</a></li>
  <li class="active">{{ service.name }}</li>
</ol>

<div class="row">

  <div class="col-lg-8">
    <div class="panel panel-default">
      <div class="panel-body">
        <input type="search" placeholder="Rechercher..." ng-model="q" class="form-control">
        <br />
        <p style="color:green">
          {{ count | number }} résultat(s) trouvé(s)
          <span ng-if="count"> - Résultats {{ firstResultPos | number }} à {{ lastResultPos | number }}</span>
        </p>
      </div>
    </div>
    <table class="table">
      <tr ng-repeat="dataset in datasets | orderBy:'-score'">
        <td class="vert">
          <h5><a href="/services/{{ service._id }}/datasets/{{ dataset._id }}">{{ dataset.metadata.title }}</a></h5>
          <p>{{ dataset.metadata.abstract | prune:500 }}</p>
          <div class="small">
            <div ng-if="dataset.metadata.keywords">
              <strong><i class="fa fa-tag"></i> Mots-clés :</strong>
              <span ng-repeat="keyword in dataset.metadata.keywords track by $index">
                <a href="?keyword={{ encodeURIComponent(keyword) }}" ng-click="applyFacet({ name: 'keyword', value: keyword })">{{ keyword }}</a>{{ $last ? '' : ',' }}
              </span>
            </div>
            <div ng-if="dataset.organizations">
              <strong><i class="fa fa-building"></i> Organismes :</strong>
              <span ng-repeat="org in dataset.organizations">
                <a href="?organization={{ encodeURIComponent(org) }}" ng-click="applyFacet({ name: 'organization', value: org })">{{ org }}</a>{{ $last ? '' : ',' }}
              </span>
            </div>
          </div>
        </td>
      </tr>
    </table>
    <ul class="pager">
      <li class="previous" ng-if="hasPreviousResults()"><a ng-click="paginatePrevious()">&larr; Précédent</a></li>
      <li class="next" ng-if="hasNextResults()"><a ng-click="paginateNext()">Suivant &rarr;</a></li>
    </ul>
  </div>

  <div class="col-lg-4">
    <div ng-repeat="facetType in facets" ng-if="facetType.values.length > 0">
      <h4>{{ facetType.label }}</h4>
      <div class="list-group">
        <a href="#" class="list-group-item" ng-repeat="facetValue in facetType.values" ng-click="toggleFacet({ name: facetType.name, value: facetValue.value })" ng-class="{ active: facetIsActive({ name: facetType.name, value: facetValue.value }) }">
          <span class="badge">{{ facetValue.count }}</span>
          {{ facetType.valueLabels[facetValue.value] || facetValue.value }}
        </a>
      </div>
    </div>
  </div>

</div>
