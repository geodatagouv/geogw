<ol class="breadcrumb">
  <li>Accueil</li>
  <li class="active">Services</li>
</ol>

<table class="table table-hover">
  <tr>
    <th>Protocole</th>
    <th>Nom du service</th>
    <th>Nombre d'entrées</th>
    <th>État</th>
    <th ng-if="session.loggedIn"></th>
  </tr>
  <tr ng-repeat="service in services">
    <td class="vert"><span class="label label-warning">{{ service.protocol | uppercase }}</span></td>
    <td class="vert"><a href="/services/{{ service._id }}/datasets">{{ service.name }}</a></td>
    <td class="vert">{{ service.items | number }}</td>
    <td class="vert">
      <span style="color: green" ng-if="service.harvesting.state === 'idle'">OK</span>
      <span style="color: purple" ng-if="service.harvesting.state === 'queued'">En attente</span>
      <span style="color: orange" ng-if="service.harvesting.state === 'processing'">En cours</span>
      <span style="color: red" ng-if="service.harvesting.state === 'error'">Erreur</span>
    </td>
    <td class="vert" ng-if="session.loggedIn">
        <a style="cursor: pointer" ng-if="service.harvesting.state === 'idle'" ng-click="harvest(service)">Moissonner</a>
    </td>
  </tr>
</table>

<div ng-if="session.loggedIn">
  <button ng-click="initNewService()" ng-if="!newService" class="btn btn-primary">
      <i class="fa fa-plus"></i> Ajouter un nouveau service
  </button>

  <div ng-if="newService" class="panel panel-default">
    <div class="panel-body">
      <div class="form-group">
        <label>Adresse du service</label>
        <input type="text" ng-model="newService.location" placeholder="http://monserviceogc.monterritoire.fr/ows" class="form-control">
      </div>
      <div class="form-group">
        <label>Nom du service</label>
        <input type="text" ng-model="newService.name" placeholder="Service CSW du canton de ..." class="form-control">
      </div>
      <button ng-click="saveNewService()" class="btn btn-primary">Valider</button>
    </div>
  </div>
</div>
